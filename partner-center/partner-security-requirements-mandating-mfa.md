---
title: 为合作伙伴租户强制执行多重身份验证 (MFA)
ms.topic: article
ms.date: 10/29/2020
ms.service: partner-dashboard
ms.subservice: partnercenter-csp
description: 了解对合作伙伴租户强制执行 MFA 将如何有助于保护对客户资源的访问。 包括示例方案。
author: isaiahwilliams
ms.author: iswillia
ms.localizationpriority: high
ms.custom: SEOMAY.20
ms.openlocfilehash: 9fe1d894ec933072a64f2abdfbb795b6ef046168
ms.sourcegitcommit: 376a49bcd245d3358a78871128761175a96ec200
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/17/2021
ms.locfileid: "112276002"
---
# <a name="mandating-multi-factor-authentication-mfa-for-your-partner-tenant"></a><span data-ttu-id="ff6b0-104">为合作伙伴租户强制执行多重身份验证 (MFA)</span><span class="sxs-lookup"><span data-stu-id="ff6b0-104">Mandating multi-factor authentication (MFA) for your partner tenant</span></span>

<span data-ttu-id="ff6b0-105">相应的角色：管理员代理 | 销售代理 | 支持人员代理 | 计费管理员 | 全局管理员</span><span class="sxs-lookup"><span data-stu-id="ff6b0-105">**Appropriate roles**: Admin agent | Sales agent | Helpdesk agent | Billing admin | Global admin</span></span>

<span data-ttu-id="ff6b0-106">本文提供了在合作伙伴中心强制执行多重身份验证 (MFA) 的详细示例和指导。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-106">This article gives detailed examples and guidance for mandating multi-factor authentication (MFA) in Partner Center.</span></span> <span data-ttu-id="ff6b0-107">此功能的目的是帮助合作伙伴保护他们对客户资源的访问，防止凭据遭到泄露。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-107">The intent of this feature is to help partners secure their access to customer resources against credentials compromise.</span></span> <span data-ttu-id="ff6b0-108">合作伙伴必须为其合作伙伴租户中的所有用户帐户（包括来宾用户）强制实施 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-108">Partners are required to enforce MFA for all user accounts in their partner tenant, including guest users.</span></span> <span data-ttu-id="ff6b0-109">将针对以下方面强制这些用户完成 MFA 验证：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-109">Users will be mandated to complete MFA verification for the following areas:</span></span>

- [<span data-ttu-id="ff6b0-110">合作伙伴中心仪表板</span><span class="sxs-lookup"><span data-stu-id="ff6b0-110">Partner Center Dashboard</span></span>](#partner-center-dashboard)
- [<span data-ttu-id="ff6b0-111">合作伙伴中心 API</span><span class="sxs-lookup"><span data-stu-id="ff6b0-111">Partner Center API</span></span>](#partner-center-api)
- [<span data-ttu-id="ff6b0-112">合作伙伴委派的管理</span><span class="sxs-lookup"><span data-stu-id="ff6b0-112">Partner Delegated Administration</span></span>](#partner-delegated-administration)

<span data-ttu-id="ff6b0-113">提供更大力度的持续性安全和隐私保护是我们的首要任务，并且我们会继续帮助合作伙伴保护他们的客户和租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-113">Greater and ongoing security and privacy safeguards are among our top priorities and we continue to help partners protect their customers and tenants.</span></span> <span data-ttu-id="ff6b0-114">参与云解决方案提供商 (CSP) 计划的所有合作伙伴、控制面板供应商 (CPV) 和顾问都应实施[合作伙伴安全要求](partner-security-requirements.md)以保持合规性。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-114">All partners participating in the Cloud Solution Provider (CSP) program, Control Panel Vendors (CPVs), and Advisors should implement the [Partner Security Requirements](partner-security-requirements.md) to stay compliant.</span></span>

<span data-ttu-id="ff6b0-115">为帮助合作伙伴保护其业务和客户免受身份盗用和未经授权的访问，我们为合作伙伴租户激活了额外的安全保护措施，以强制执行并验证 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-115">To help partners protect their businesses and customers from identity-theft and unauthorized access, we activated additional security safeguards for partner tenants which mandate and verify MFA.</span></span> 

## <a name="partner-center-dashboard"></a><span data-ttu-id="ff6b0-116">合作伙伴中心面板</span><span class="sxs-lookup"><span data-stu-id="ff6b0-116">Partner Center dashboard</span></span>

<span data-ttu-id="ff6b0-117">合作伙伴中心面板中的某些页面将受到 MFA 的保护，包括：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-117">Certain pages in the Partner Center dashboard will be MFA-protected, including:</span></span>

- <span data-ttu-id="ff6b0-118">“客户”选项卡下的所有页面，例如可以通过以下 URL 访问的所有页面： https://partner.microsoft.com/commerce/\*</span><span class="sxs-lookup"><span data-stu-id="ff6b0-118">All pages under the **Customers** tab, e.g all pages that can be accessed through the following URL: https://partner.microsoft.com/commerce/\*</span></span>
- <span data-ttu-id="ff6b0-119">“支持”>“客户请求”选项卡下的所有页面，例如通过 https://partner.microsoft.com/dashboard/support/csp/customers/\* 访问的页面</span><span class="sxs-lookup"><span data-stu-id="ff6b0-119">All pages under the **Support > Customer requests** tab, e.g the page accessed under https://partner.microsoft.com/dashboard/support/csp/customers/\*</span></span>
- <span data-ttu-id="ff6b0-120">计费页面</span><span class="sxs-lookup"><span data-stu-id="ff6b0-120">Billing page</span></span>

<span data-ttu-id="ff6b0-121">下表显示了哪些用户类型有权访问这些受 MFA 保护的页面（因此会受到此功能的影响）。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-121">The following table shows which user types are authorized to access these MFA-protected pages (and are therefore affected by this feature).</span></span>


| <span data-ttu-id="ff6b0-122">受 MFA 保护的页面</span><span class="sxs-lookup"><span data-stu-id="ff6b0-122">MFA-protected page</span></span>       | <span data-ttu-id="ff6b0-123">管理员代理</span><span class="sxs-lookup"><span data-stu-id="ff6b0-123">Admin agents</span></span>      |  <span data-ttu-id="ff6b0-124">销售代理</span><span class="sxs-lookup"><span data-stu-id="ff6b0-124">Sales agents</span></span>     |   <span data-ttu-id="ff6b0-125">支持人员代理</span><span class="sxs-lookup"><span data-stu-id="ff6b0-125">Helpdesk agents</span></span>     | <span data-ttu-id="ff6b0-126">全局管理员</span><span class="sxs-lookup"><span data-stu-id="ff6b0-126">Global administrator</span></span>      |  <span data-ttu-id="ff6b0-127">帐务管理员</span><span class="sxs-lookup"><span data-stu-id="ff6b0-127">Billing administrator</span></span>     | 
|---    |---    |---    |---    |---    |---    |
| <span data-ttu-id="ff6b0-128">“客户”选项卡下的所有页面</span><span class="sxs-lookup"><span data-stu-id="ff6b0-128">All pages under Customers tab</span></span>      |   <span data-ttu-id="ff6b0-129">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-129">x</span></span>    |    <span data-ttu-id="ff6b0-130">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-130">x</span></span>   |  <span data-ttu-id="ff6b0-131">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-131">x</span></span>     |       |       |
| <span data-ttu-id="ff6b0-132">“支持”>“客户请求”选项卡下的所有页面</span><span class="sxs-lookup"><span data-stu-id="ff6b0-132">All pages under Support > Customer requests tab</span></span>     | <span data-ttu-id="ff6b0-133">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-133">x</span></span>      |       |    <span data-ttu-id="ff6b0-134">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-134">x</span></span>   |       |       |
| <span data-ttu-id="ff6b0-135">计费页面</span><span class="sxs-lookup"><span data-stu-id="ff6b0-135">Billing page</span></span>     |   <span data-ttu-id="ff6b0-136">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-136">x</span></span>    |       |       |    <span data-ttu-id="ff6b0-137">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-137">x</span></span>   |   <span data-ttu-id="ff6b0-138">x</span><span class="sxs-lookup"><span data-stu-id="ff6b0-138">x</span></span>    |

<span data-ttu-id="ff6b0-139">如果你要尝试访问任一这些页面并且之前尚未完成 MFA 验证，则需要执行此操作。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-139">If you try to access any of these pages and you haven't completed MFA verification earlier, you will be required to do so.</span></span> <span data-ttu-id="ff6b0-140">合作伙伴中心的其他页面（例如“概览”页面、“服务运行状况状态”检查页面）不需要 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-140">Other pages on Partner Center such as the Overview page, Service Health Status check page do not require MFA.</span></span>

## <a name="verification-examples"></a><span data-ttu-id="ff6b0-141">验证示例</span><span class="sxs-lookup"><span data-stu-id="ff6b0-141">Verification examples</span></span>

<span data-ttu-id="ff6b0-142">为了说明验证在合作伙伴中心面板的工作原理，我们列举了以下示例。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-142">To illustrate how verification works in the Partner Center dashboard, consider the following examples.</span></span>

### <a name="example-1-partner-has-implemented-azure-ad-mfa"></a><span data-ttu-id="ff6b0-143">示例 1：合作伙伴已实现 Azure AD MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-143">Example 1: Partner has implemented Azure AD MFA</span></span>

1. <span data-ttu-id="ff6b0-144">Jane 在 CSP Contoso 工作。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-144">Jane works for CSP Contoso.</span></span> <span data-ttu-id="ff6b0-145">Contoso 已使用 Azure Active Directory (Azure AD) MFA 为其 Contoso 合作伙伴租户下的所有用户实现了 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-145">Contoso has implemented MFA for all their users under Contoso partner tenant using Azure Active Directory (Azure AD) MFA.</span></span>

2. <span data-ttu-id="ff6b0-146">Jane 启动了一个新的浏览器会话并导航到合作伙伴中心面板概览页面（此页面不受 MFA 保护）。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-146">Jane starts a new browser session and navigates to Partner Center dashboard overview page (which isn't MFA-protected).</span></span> <span data-ttu-id="ff6b0-147">合作伙伴中心将 Jane 重定向到 Azure AD 以进行登录。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-147">Partner Center redirects Jane to Azure AD to sign in.</span></span>

3. <span data-ttu-id="ff6b0-148">由于 Contoso 设置的现有 Azure AD MFA，Jane 需要完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-148">Due to the existing Azure AD MFA setup by Contoso, Jane is required to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-149">成功完成登录和 MFA 验证后，Jane 会被重定向回合作伙伴中心面板概览页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-149">Upon successful sign-in and MFA verification, Jane is redirected back to Partner Center dashboard overview page.</span></span>

4. <span data-ttu-id="ff6b0-150">Jane 尝试访问合作伙伴中心中任一受 MFA 保护的页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-150">Jane tries to access one of the MFA-protected pages in Partner Center.</span></span> <span data-ttu-id="ff6b0-151">由于 Jane 在之前登录期间已经完成了 MFA 验证，因此，Jane 可以访问受 MFA 保护的页面，无需再次进行 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-151">Since Jane has already completed MFA verification during sign-in earlier, Jane can access the MFA-protected page without being required to go through MFA verification again.</span></span>

### <a name="example-2-partner-has-implemented-third-party-mfa-using-identity-federation"></a><span data-ttu-id="ff6b0-152">示例 2：合作伙伴已使用联合身份验证实现了第三方 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-152">Example 2: Partner has implemented third-party MFA using identity federation</span></span>

1. <span data-ttu-id="ff6b0-153">Trent 在云解决方案提供商 Wingtip 工作。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-153">Trent works for CSP Wingtip.</span></span> <span data-ttu-id="ff6b0-154">Wingtip 已使用第三方 MFA（通过联合身份验证与 Azure AD 相集成）为他们 Wingtip 合作伙伴租户下的所有用户实现了 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-154">Wingtip has implemented MFA for all their users under Wingtip partner tenant using third-party MFA, which is integrated with Azure AD via identity federation.</span></span>

2. <span data-ttu-id="ff6b0-155">Trent 启动了一个新的浏览器会话并导航到合作伙伴中心面板概览页面（此页面不受 MFA 保护）。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-155">Trent starts a new browser session and navigates to Partner Center dashboard overview page (which isn't MFA-protected).</span></span> <span data-ttu-id="ff6b0-156">合作伙伴中心将 Trent 重定向到 Azure AD 以进行登录。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-156">Partner Center redirects Trent to Azure AD to sign in.</span></span>

3. <span data-ttu-id="ff6b0-157">由于 Wingtip 设置了联合身份验证，因此 Azure AD 会将 Trent 重定向到联合身份验证标识提供程序以完成登录和 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-157">Since Wingtip has setup identity federation, Azure AD redirects Trent to the federated identity provider to complete sign-in and MFA verification.</span></span> <span data-ttu-id="ff6b0-158">成功完成登录和 MFA 验证后，Trent 会被重定向回 Azure AD，然后再回到合作伙伴中心面板概览页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-158">Upon successful sign-in and MFA verification, Trent is redirected back to Azure AD and then to Partner Center dashboard overview page.</span></span>

4. <span data-ttu-id="ff6b0-159">Trent 尝试访问合作伙伴中心中任一受 MFA 保护的页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-159">Trent tries to access one of the MFA-protected pages in Partner Center.</span></span> <span data-ttu-id="ff6b0-160">由于 Trent 在之前登录期间已经完成了 MFA 验证，因此，Trent 可以访问受 MFA 保护的页面，无需再次进行 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-160">Since Trent has already completed MFA verification during sign-in earlier, Trent can access the MFA protected page without being required to go through MFA verification again.</span></span>

### <a name="example-3-partner-hasnt-implemented-mfa"></a><span data-ttu-id="ff6b0-161">示例 3：合作伙伴未实现 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-161">Example 3: Partner hasn't implemented MFA</span></span>

1. <span data-ttu-id="ff6b0-162">John 在云解决方案提供商 Fabrikam 工作。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-162">John works for CSP Fabrikam.</span></span> <span data-ttu-id="ff6b0-163">Fabrikam 没有为 Fabrikam 合作伙伴租户下的任何用户实现 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-163">Fabrikam hasn't implemented MFA for any user under Fabrikam partner tenant.</span></span>

2. <span data-ttu-id="ff6b0-164">John 启动了一个新的浏览器会话并导航到合作伙伴中心面板概览页面（此页面不受 MFA 保护）。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-164">John starts a new browser session and navigates to Partner Center dashboard overview page (which isn't MFA-protected).</span></span> <span data-ttu-id="ff6b0-165">合作伙伴中心将 John 重定向到 Azure AD 以进行登录。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-165">Partner Center redirects John to Azure AD to sign in.</span></span>

3. <span data-ttu-id="ff6b0-166">由于 Fabrikam 尚未实现 MFA，因此 John 不需要完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-166">Since Fabrikam hasn't implemented MFA, John isn't required to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-167">成功完成登录后，John 会被重定向回合作伙伴中心面板概览页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-167">Upon successful sign-in, John is redirected back to Partner Center dashboard overview page.</span></span>

4. <span data-ttu-id="ff6b0-168">John 尝试访问合作伙伴中心中任一受 MFA 保护的页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-168">John tries to access one of the MFA-protected pages in Partner Center.</span></span> <span data-ttu-id="ff6b0-169">由于 John 未完成 MFA 验证，因此，合作伙伴中心将 John 重定向到 Azure AD 以完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-169">Since John hasn't completed MFA verification, Partner Center redirects John to Azure AD to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-170">由于这是 John 第一次需要完成 MFA，John 还被要求[注册 MFA](#mfa-registration-experience)。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-170">Since this is the first time John is required to complete MFA, John is also requested to [register for MFA](#mfa-registration-experience).</span></span> <span data-ttu-id="ff6b0-171">在成功完成 MFA 注册和 MFA 验证后，John 现在可以访问受 MFA 保护的页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-171">Upon successful MFA registration and MFA verification, John can now access the MFA-protected page.</span></span>

5. <span data-ttu-id="ff6b0-172">在 Fabrikam 为任何用户实现 MFA 之前的某一天，John 启动了一个新的浏览器会话并导航到合作伙伴中心面板概览页面（此页面不受 MFA 保护）。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-172">Another day before Fabrikam implementing MFA for any user, John starts a new browser session and navigates to Partner Center dashboard overview page (which isn't MFA-protected).</span></span> <span data-ttu-id="ff6b0-173">合作伙伴中心将 John 重定向到了 Azure AD 以进行登录，没有提示他要完成 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-173">Partner Center redirects John to Azure AD to sign in without MFA prompt.</span></span> 

6. <span data-ttu-id="ff6b0-174">John 尝试访问合作伙伴中心中任一受 MFA 保护的页面。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-174">John tries to access one of the MFA-protected pages in Partner Center.</span></span> <span data-ttu-id="ff6b0-175">由于 John 未完成 MFA 验证，因此，合作伙伴中心将 John 重定向到 Azure AD 以完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-175">Since John hasn't completed MFA verification, Partner Center redirects John to Azure AD to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-176">由于 John 已注册了 MFA，因此这次只要求他完成 MFA 验证即可。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-176">Since John has registered MFA, so this time he is only asked to complete the MFA verification.</span></span>

> [!NOTE]
><span data-ttu-id="ff6b0-177">操作：公司管理员有[三个选项](partner-security-requirements.md#implementing-multi-factor-authentication)来实现 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-177">Action: Company administrators have [three options](partner-security-requirements.md#implementing-multi-factor-authentication) for implementing MFA.</span></span>

## <a name="partner-center-api"></a><span data-ttu-id="ff6b0-178">合作伙伴中心 API</span><span class="sxs-lookup"><span data-stu-id="ff6b0-178">Partner Center API</span></span>

<span data-ttu-id="ff6b0-179">合作伙伴中心 API 同时支持“仅应用”身份验证和“应用+用户”身份验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-179">The Partner Center API supports both App-only authentication and App+User authentication.</span></span> 

<span data-ttu-id="ff6b0-180">使用应用+用户身份验证时，合作伙伴中心将要求进行 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-180">When App+User authentication is used, Partner Center will require MFA verification.</span></span> <span data-ttu-id="ff6b0-181">更具体地说，当合作伙伴应用程序想将 API 请求发送到合作伙伴中心时，它必须在请求的授权标头中包含一个访问令牌。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-181">More specifically, when a partner application wants to send an API request to Partner Center, it must include an access token in the Authorization header of the request.</span></span> 

> [!NOTE]
><span data-ttu-id="ff6b0-182">[安全应用程序模型框架](/partner-center/develop/enable-secure-app-model)是一种可缩放的框架，用于在你调用合作伙伴中心 API 时通过 Microsoft Azure MFA 体系结构对 CSP 合作伙伴和 CPV 进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-182">The [Secure Application Model framework](/partner-center/develop/enable-secure-app-model) is a scalable framework for authenticating CSP partners and CPVs through the Microsoft Azure MFA architecture when calling Partner Center APIs.</span></span> <span data-ttu-id="ff6b0-183">在对租户启用 MFA 之前，需要实现此框架。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-183">You need to implement this framework before enabling MFA on your tenant.</span></span> 

<span data-ttu-id="ff6b0-184">当合作伙伴中心收到带有使用“应用+用户”身份验证获得的访问令牌的 API 请求时，合作伙伴中心 API 将检查身份验证方法引用 (AMR) 声明中是否存在“MFA”值 。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-184">When Partner Center receives an API request with an access token obtained using App+User authentication, the Partner Center API will check for the presence of the *MFA* value in the *Authentication Method Reference (AMR)* claim.</span></span> <span data-ttu-id="ff6b0-185">你可以使用 JWT 解码器来验证访问令牌是否包含所需的身份验证方法引用 (AMR) 值：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-185">You can use a JWT decoder to validate whether an access token contains the expected authentication method reference (AMR) value or not:</span></span>

``` csharp
{
  "aud": "https://api.partnercenter.microsoft.com",
  "iss": "https://sts.windows.net/df845f1a-7b35-40a2-ba78-6481de91f8ae/",
  "iat": 1549088552,
  "nbf": 1549088552,
  "exp": 1549092452,
  "acr": "1",
  "amr": [
    "pwd",
    "mfa"
  ],
  "appid": "23ec45a3-5127-4185-9eff-c8887839e6ab",
  "appidacr": "0",
  "family_name": "Adminagent",
  "given_name": "CSP",
  "ipaddr": "127.0.0.1",
  "name": "Adminagent CSP",
  "oid": "4988e250-5aee-482a-9136-6d269cb755c0",
  "scp": "user_impersonation",
  "tenant_region_scope": "NA",
  "tid": "df845f1a-7b35-40a2-ba78-6481de91f8ae",
  "unique_name": "Adminagent.csp@testtestpartner.onmicrosoft.com",
  "upn": "Adminagent.csp@testtestpartner.onmicrosoft.com",
  "ver": "1.0"
}
```

<span data-ttu-id="ff6b0-186">如果值存在，合作伙伴中心则会得出已完成 MFA 验证的结论并处理 API 请求。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-186">If the value is present, Partner Center concludes that MFA verification was completed and processes the API request.</span></span> <span data-ttu-id="ff6b0-187">如果值不存在，合作伙伴中心 API 将拒绝请求，并返回以下响应：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-187">If the value isn't present, Partner Center API will reject the request with the following response:</span></span>

``` csharp
HTTP/1.1 401 Unauthorized - MFA required
Transfer-Encoding: chunked
Request-Context: appId=cid-v1:03ce8ca8-8373-4021-8f25-d5dd45c7b12f
WWW-Authenticate: Bearer error="invalid_token"
Date: Thu, 14 Feb 2019 21:54:58 GMT
```

<span data-ttu-id="ff6b0-188">当使用“仅应用”身份验证时，支持“仅应用”身份验证的 API 将持续运行，而无需 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-188">When App-Only authentication is used, the APIs that support App-Only authentication will be continuously working without requiring MFA.</span></span>

## <a name="partner-delegated-administration"></a><span data-ttu-id="ff6b0-189">合作伙伴委派的管理</span><span class="sxs-lookup"><span data-stu-id="ff6b0-189">Partner Delegated Administration</span></span>

<span data-ttu-id="ff6b0-190">合作伙伴帐户（包括管理员代理和支持人员代理）可以使用他们的合作伙伴委派管理员权限来通过 Microsoft Online Services 门户、命令行接口 (CLI) 和 API（使用的是“应用+用户”身份验证）管理客户资源。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-190">Partner accounts, including Admin Agents and Helpdesk Agents, can use their Partner Delegated Admin Privileges to manage customer resources through Microsoft Online Services Portals, command-line interface (CLI), and APIs (using App+User authentication).</span></span>

### <a name="using-service-portals"></a><span data-ttu-id="ff6b0-191">使用服务门户</span><span class="sxs-lookup"><span data-stu-id="ff6b0-191">Using service portals</span></span>

<span data-ttu-id="ff6b0-192">当使用“合作伙伴委派管理员权限(代表管理员)”来访问 Microsoft Online Services 门户时，这些门户中的许多门户都需要合作伙伴帐户以交互方式与设置为身份验证上下文的客户 Azure AD 租户进行身份验证 - 合作伙伴帐户需要登录客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-192">When accessing Microsoft Online Services Portals using the Partner Delegated Admin Privileges(Admin-On-Behalf-Of) to manage customer resources, many of these portals require the partner account to authenticate interactively, with the customer Azure AD tenant set as the authentication context - the partner account is required to sign into the customer tenant.</span></span>

<span data-ttu-id="ff6b0-193">当 Azure AD 收到此类身份验证请求时，它将要求合作伙伴帐户完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-193">When Azure AD receives such authentication requests, it will require the partner account to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-194">可以使用两种用户体验，具体取决于合作伙伴帐户是托管标识还是联合身份标识：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-194">There are two possible user experiences, depending on whether the partner account is a managed or federated identity:</span></span>

- <span data-ttu-id="ff6b0-195">如果合作伙伴帐户是托管标识，Azure AD 将直接提示用户完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-195">If the partner account is a **managed** identity, Azure AD will directly prompt the user to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-196">如果合作伙伴帐户之前尚未通过 Azure AD 注册 MFA，系统将要求用户首先[完成 MFA 注册](#mfa-registration-experience)。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-196">If the partner account has not registered for MFA with Azure AD before, the user will be asked to [complete MFA registration](#mfa-registration-experience) first.</span></span>

- <span data-ttu-id="ff6b0-197">如果合作伙伴帐户是联合身份标识，体验将取决于合作伙伴管理员在 Azure AD 中配置联合验证的方式。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-197">If the partner account is a **federated** identity, the experience is dependent on how the partner administrator has configured federation in Azure AD.</span></span> <span data-ttu-id="ff6b0-198">在 Azure AD 中设置联合验证时，合作伙伴管理员可以向 Azure AD 指示联合身份验证标识提供程序是否支持 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-198">When setting up federation in Azure AD, the partner administrator can indicate to Azure AD whether the federated identity provider supports MFA or not.</span></span> <span data-ttu-id="ff6b0-199">如果支持，Azure AD 会将用户重定向到联合身份验证标识提供程序以完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-199">If so, Azure AD will redirect the user to the federated identity provider to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-200">否则，Azure AD 将直接提示用户完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-200">Otherwise, Azure AD will directly prompt the user to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-201">如果合作伙伴帐户之前尚未通过 Azure AD 注册 MFA，系统将要求用户首先[完成 MFA 注册](#mfa-registration-experience)。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-201">If the partner account has not registered for MFA with Azure AD before, the user will be asked to [complete MFA registration](#mfa-registration-experience) first.</span></span>

<span data-ttu-id="ff6b0-202">整体体验与最终客户租户为它的管理员实现了 MFA 的方案类似。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-202">The overall experience is similar to the scenario where an end customer tenant has implemented MFA for its administrators.</span></span> <span data-ttu-id="ff6b0-203">例如，客户租户启用了 [Azure AD 安全默认设置](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults)，这要求具有管理权限的所有帐户通过 MFA 验证登录到客户租户，包括管理员代理和支持人员代理。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-203">For example, the customer tenant has enabled [Azure AD security defaults](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults), which requires all accounts with administrative rights to sign into the customer tenant with MFA verification, including Admin Agents and Helpdesk Agents.</span></span> <span data-ttu-id="ff6b0-204">出于测试目的，合作伙伴可以在客户租户中启用 [Azure AD 安全默认设置](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults)，然后尝试使用合作伙伴委派的管理权限来访问客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-204">For testing purposes, partners can enable the [Azure AD security defaults](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults) in the customer tenant and then try using Partner Delegated Administration Privileges to access the customer tenant.</span></span>

> [!NOTE]
> <span data-ttu-id="ff6b0-205">并非所有 Microsoft Online Service 门户都需要合作伙伴帐户在使用合作伙伴委派的管理员权限访问客户资源时登录到客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-205">Not all Microsoft Online Service Portals require partner accounts to sign into the customer tenant when accessing customer resources using Partner Delegated Admin Privileges.</span></span> <span data-ttu-id="ff6b0-206">相反，它们只要求合作伙伴帐户登录到合作伙伴租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-206">Instead, they only require the partner accounts to sign into the partner tenant.</span></span> <span data-ttu-id="ff6b0-207">Exchange 管理中心就是一个例子。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-207">An example is the Exchange Admin Center.</span></span> <span data-ttu-id="ff6b0-208">随着时间的推移，我们希望这些门户要求合作伙伴帐户在使用合作伙伴委派的管理员权限时登录到客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-208">Over time, we expect these portals to require partner accounts to sign into the customer tenant when using Partner Delegated Admin Privileges.</span></span>

### <a name="using-service-apis"></a><span data-ttu-id="ff6b0-209">使用服务 API</span><span class="sxs-lookup"><span data-stu-id="ff6b0-209">Using service APIs</span></span>

<span data-ttu-id="ff6b0-210">某些 Microsoft Online Services API（例如 Azure 资源管理器、Azure AD Graph 和 Microsoft Graph等）支持合作伙伴使用合作伙伴委派的管理员权限以编程方式管理客户资源。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-210">Some Microsoft Online Services APIs (such as Azure Resource Manager, Azure AD Graph, Microsoft Graph, etc.) support partners using Partner Delegated Admin Privileges to programmatically manage customer resources.</span></span> <span data-ttu-id="ff6b0-211">若要通过这些 API 来使用合作伙伴委派的管理员权限，合作伙伴应用程序必须在 API 请求授权标头中包含访问令牌，此访问令牌是让合作伙伴用户帐户通过 Azure AD 进行身份验证（将客户 Azure AD 设置为身份验证上下文）所获取的。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-211">To use Partner Delegated Admin Privileges with these APIs, the partner application must include an access token in the API request Authorization header, where the access token is obtained by having a partner user account to authenticate with Azure AD, with the customer Azure AD set as the authentication context.</span></span> <span data-ttu-id="ff6b0-212">合作伙伴应用程序要求合作伙伴用户帐户登录客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-212">The partner application is required to have a partner user account sign in to the customer tenant.</span></span>

<span data-ttu-id="ff6b0-213">当 Azure AD 收到此类身份验证请求时，Azure AD 将要求合作伙伴用户帐户完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-213">When Azure AD receives such as authentication request, Azure AD will require the partner user account to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-214">如果合作伙伴用户帐户之前尚未注册 MFA，系统将提示此用户帐户首先完成 MFA 注册。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-214">If the partner user account hasn't registered for MFA before, the user account will be prompted to complete MFA registration first.</span></span>

<span data-ttu-id="ff6b0-215">使用合作伙伴委派的管理员权限与这些 API 集成的所有合作伙伴应用程序会受到此功能的影响。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-215">All partner applications that are integrated with these APIs using Partner Delegated Admin Privileges are affected by this feature.</span></span> <span data-ttu-id="ff6b0-216">确保合作伙伴应用程序可以继续使用这些 API，不会发生中断：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-216">To ensure partner applications can continue to work with these APIs without interruption:</span></span>

- <span data-ttu-id="ff6b0-217">合作伙伴必须避免将非交互式用户身份验证方法与 Azure AD 配合使用才能获取访问令牌。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-217">Partner must avoid using non-interactive user authentication method with Azure AD to obtain the access token.</span></span> <span data-ttu-id="ff6b0-218">使用非交互式用户身份验证方法时（例如[密码流](https://github.com/AzureAD/azure-activedirectory-library-for-dotnet/wiki/Acquiring-tokens-with-username-and-password)），Azure AD 将无法提示用户完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-218">When using non-interactive user authentication method such as [Password Flow](https://github.com/AzureAD/azure-activedirectory-library-for-dotnet/wiki/Acquiring-tokens-with-username-and-password), Azure AD will not be able to prompt the user to complete MFA verification.</span></span> <span data-ttu-id="ff6b0-219">合作伙伴必须改用交互式用户身份验证方法，例如 [OpenID Connect 流](/azure/active-directory/develop/v1-protocols-openid-connect-code)。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-219">Partner must switch to using interactive user authentication method such as [OpenID Connect flow](/azure/active-directory/develop/v1-protocols-openid-connect-code) instead.</span></span>

- <span data-ttu-id="ff6b0-220">在使用交互式用户身份验证方法期间，合作伙伴应使用已启用了 MFA 的合作伙伴用户帐户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-220">During interactive user authentication method, partner should use a partner user account that is already enabled for MFA.</span></span> <span data-ttu-id="ff6b0-221">或者，在 Azure AD 提示时，合作伙伴可以在登录期间完成 MFA 注册和 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-221">Alternatively, when prompted by Azure AD, partner can complete MFA registration and MFA verification during sign-in.</span></span>

- <span data-ttu-id="ff6b0-222">这与最终客户租户为它的管理员实现了 MFA 的情况类似。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-222">This is similar to the scenario where an end customer tenant has implemented MFA for its administrators.</span></span> <span data-ttu-id="ff6b0-223">例如，客户租户启用了 [Azure AD 安全默认设置](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults)，这要求具有管理权限的所有用户帐户通过 MFA 验证登录到客户租户，包括管理员代理和支持人员代理。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-223">For example, the customer tenant has enabled [Azure AD security defaults](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults), which requires all user accounts with administrative rights to sign into the customer tenant with MFA verification, including Admin Agents and Helpdesk Agents.</span></span> <span data-ttu-id="ff6b0-224">出于测试目的，合作伙伴可以在客户租户中启用 [Azure AD 安全默认设置](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults)，然后尝试使用合作伙伴委派的管理权限以编程方式访问客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-224">For testing purposes, partners can enable the [Azure AD security defaults](/azure/active-directory/fundamentals/concept-fundamentals-security-defaults) in the customer tenant and then try using Partner Delegated Administration Privileges to programmatically access the customer tenant.</span></span>

### <a name="mfa-registration-experience"></a><span data-ttu-id="ff6b0-225">MFA 注册体验</span><span class="sxs-lookup"><span data-stu-id="ff6b0-225">MFA registration experience</span></span>

<span data-ttu-id="ff6b0-226">在 MFA 验证期间，如果合作伙伴帐户之前尚未注册 MFA，Azure AD 将提示此用户首先完成 MFA 注册：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-226">During MFA verification, if the partner account hasn't registered for MFA before, Azure AD will prompt the user to complete MFA registration first:</span></span>

:::image type="content" source="images/MfaRegistration1.png" alt-text="MFA 注册步骤 1。":::

<span data-ttu-id="ff6b0-228">单击“下一步”后，系统将要求用户从验证方法列表中进行选择。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-228">After clicking **Next**, the user will be asked to choose from a list of verification methods.</span></span>

:::image type="content" source="images/MfaRegistration2.png" alt-text="MFA 注册步骤 2。":::

<span data-ttu-id="ff6b0-230">成功注册后，用户需要根据所选择的验证完成 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-230">Upon successful registration, the user is then required to complete MFA verification based on the verification chosen by the user.</span></span>
 
## <a name="list-of-common-issues"></a><span data-ttu-id="ff6b0-231">常见问题列表</span><span class="sxs-lookup"><span data-stu-id="ff6b0-231">List of common issues</span></span>

<span data-ttu-id="ff6b0-232">在申请 MFA 要求的[技术例外](#how-to-submit-a-request-for-technical-exception)之前，请查看由其他合作伙伴报告的常见问题列表以了解你的请求是否有效。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-232">Before applying for [technical exception](#how-to-submit-a-request-for-technical-exception) from the MFA requirement, review the list of common issues reported by other partners to understand whether your request is valid.</span></span>

#### <a name="issue-1-partner-needs-more-time-to-implement-mfa-for-their-partner-agents"></a><span data-ttu-id="ff6b0-233">问题 1：合作伙伴需要更多的时间来为他们的合作伙伴代理实现 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-233">Issue 1: Partner needs more time to implement MFA for their partner agents</span></span>
<span data-ttu-id="ff6b0-234">合作伙伴尚未为他们的合作伙伴代理实现 MFA 或者正在实现过程中，这些代理需要使用合作伙伴委派的管理权限来访问 Microsoft Online Services 门户以管理客户资源。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-234">A partner hasn't started or is still in the process of implementing MFA for their partner agents who require access to Microsoft Online Services Portals using Partner Delegated Administration Privileges to manage customer resources.</span></span> <span data-ttu-id="ff6b0-235">合作伙伴需要更多的时间来完成 MFA 实现。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-235">The partner needs more time to complete MFA implementation.</span></span> <span data-ttu-id="ff6b0-236">此问题能否成为请求技术例外的有效理由？</span><span class="sxs-lookup"><span data-stu-id="ff6b0-236">Is this issue a valid reason for technical exception?</span></span>

<span data-ttu-id="ff6b0-237">**答案**：不能。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-237">**Answer**: No.</span></span> <span data-ttu-id="ff6b0-238">合作伙伴需要制定计划来为他们的用户实现 MFA，从而避免中断。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-238">Partner needs to make plans to implement MFA for their users to avoid disruption.</span></span>

> [!NOTE]
> <span data-ttu-id="ff6b0-239">即使合作伙伴尚未为他们的合作伙伴代理实现 MFA，合作伙伴代理仍然可以使用合作伙伴委派的管理权限来访问 Microsoft Online Services 门户，只要在登录到客户租户期间出现提示时他们可以完成 MFA 注册和 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-239">Even though the partner hasn't implemented MFA for their partner agents, the partner agents can still access Microsoft Online Services Portals using Partner Delegated Administration Privileges provided they can complete MFA registration and MFA verification when prompted during sign-in to customer tenant.</span></span> <span data-ttu-id="ff6b0-240">完成 MFA 注册不会自动为用户启用 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-240">Completing MFA registration does not automatically enable the user for MFA.</span></span>

##### <a name="issue-2-partner-has-not-implemented-mfa-for-user-accounts-not-using-delegated-admin-privileges"></a><span data-ttu-id="ff6b0-241">问题 2：合作伙伴尚未为未使用委派管理员权限的用户帐户实现 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-241">Issue 2: Partner has not implemented MFA for user accounts not using Delegated Admin Privileges</span></span>
<span data-ttu-id="ff6b0-242">某一合作伙伴在他们的合作伙伴租户中拥有用户，这些用户不需要使用合作伙伴委派的管理权限来访问 Microsoft Online Services 门户以管理客户资源。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-242">A partner has some users in their partner tenants who do not require access to Microsoft Online Services Portals to manage customer resources using Partner Delegated Administration Privileges.</span></span> <span data-ttu-id="ff6b0-243">合作伙伴正在为这些用户实现 MFA，需要更多的时间才能完成。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-243">The partner is in the process of implementing MFA for these users and needs more time to complete.</span></span> <span data-ttu-id="ff6b0-244">此问题能否成为请求技术例外的有效理由？</span><span class="sxs-lookup"><span data-stu-id="ff6b0-244">Is this issue a valid reason for technical exception?</span></span>

<span data-ttu-id="ff6b0-245">**答案**：不能。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-245">**Answer**: No.</span></span> <span data-ttu-id="ff6b0-246">由于这些用户帐户不使用合作伙伴委派的管理权限来管理客户资源，因此他们将不需要登录到客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-246">Since these user accounts are not using Partner Delegated Administration Privileges to manage customer resources, they will not be required to sign in to customer tenant.</span></span> <span data-ttu-id="ff6b0-247">他们不受 Azure AD 要求在登录到客户租户期间进行 MFA 验证的影响。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-247">They will not be affected by Azure AD requiring MFA verification during sign-in to customer tenant.</span></span>

##### <a name="issue-3-partner-has-not-implemented-mfa-for-user-service-accounts"></a><span data-ttu-id="ff6b0-248">问题 3：合作伙伴尚未为用户服务帐户实现 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-248">Issue 3: Partner has not implemented MFA for user service accounts</span></span>
<span data-ttu-id="ff6b0-249">某一合作伙伴在他们的合作伙伴租户中拥有一些用户帐户，这些帐户由设备作为服务帐户使用。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-249">A partner has some user accounts in their partner tenants, which are being used by devices as service accounts.</span></span> <span data-ttu-id="ff6b0-250">这些是低特权帐户，这些帐户不需要使用合作伙伴委派的管理权限来访问合作伙伴中心或 Microsoft Online Services 门户以管理客户资源。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-250">These are low privileged accounts that do not require access Partner Center nor Microsoft Online Services Portals to manage customer resources using Partner Delegated Administration Privileges.</span></span> <span data-ttu-id="ff6b0-251">此问题能否成为请求技术例外的有效理由？</span><span class="sxs-lookup"><span data-stu-id="ff6b0-251">Is this issue a valid reason for technical exception?</span></span>

<span data-ttu-id="ff6b0-252">**答案**：不能。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-252">**Answer**: No.</span></span> <span data-ttu-id="ff6b0-253">由于这些用户帐户不使用合作伙伴委派的管理权限来管理客户资源，因此他们将不需要登录到客户租户。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-253">Since these user accounts are not using Partner Delegated Administration Privileges to manage customer resources, they will not be required to sign in to customer tenant.</span></span> <span data-ttu-id="ff6b0-254">他们不受 Azure AD 要求在登录到客户租户期间进行 MFA 验证的影响。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-254">They will not be affected by Azure AD requiring MFA verification during sign-in to customer tenant.</span></span>

##### <a name="issue-4-partner-cannot-implement-mfa-using-ms-authenticator-app"></a><span data-ttu-id="ff6b0-255">问题 4：合作伙伴无法使用 MS Authenticator 应用来实现 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-255">Issue 4: Partner cannot implement MFA using MS Authenticator App</span></span>
<span data-ttu-id="ff6b0-256">合作伙伴具有“清理办公桌”政策，不允许员工将个人移动设备带到工作区。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-256">A partner has "clean desk" policy, which does not permit employees bringing their personal mobile devices to their work area.</span></span> <span data-ttu-id="ff6b0-257">在无法使用个人移动设备的情况下，员工无法安装 MS Authenticator 应用，这是 Azure AD 安全默认设置支持的唯一 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-257">Without access to their personal mobile devices, the employees cannot install the MS Authenticator App, which is the only MFA verification supported by Azure AD security defaults.</span></span> <span data-ttu-id="ff6b0-258">此问题能否成为请求技术例外的有效理由？</span><span class="sxs-lookup"><span data-stu-id="ff6b0-258">Is this issue a valid reason for technical exception?</span></span>

<span data-ttu-id="ff6b0-259">**答案**：不能，这不是请求技术例外的有效理由。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-259">**Answer**: No, this isn't a valid reason for technical exception.</span></span> <span data-ttu-id="ff6b0-260">合作伙伴应考虑以下替代方法，使他们的员工仍然可以在访问合作伙伴中心时完成 MFA 验证：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-260">The partner should consider following alternatives, so that their employees can still complete MFA verification when accessing Partner Center:</span></span>
- <span data-ttu-id="ff6b0-261">合作伙伴还可以注册 Azure AD Premium 或第三方 MFA 解决方案（与 Azure AD 兼容），此类解决方案可以提供其他验证方法。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-261">Partner can also sign up for Azure AD Premium or third-party MFA solutions (compatible with Azure AD) which can provide additional verification methods.</span></span>

##### <a name="issue-5-partner-cannot-implement-mfa-due-to-the-use-of-legacy-authentication-protocols"></a><span data-ttu-id="ff6b0-262">问题 5：由于使用的是旧式身份验证协议，合作伙伴无法实现 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-262">Issue 5: Partner cannot implement MFA due to the use of legacy authentication protocols</span></span>
<span data-ttu-id="ff6b0-263">某一合作伙伴的某些合作伙伴代理仍然在使用旧式身份验证协议，这与 MFA 不兼容。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-263">A partner has some partner agents who are still using legacy authentication protocols, which aren't MFA compatible.</span></span> <span data-ttu-id="ff6b0-264">例如，用户仍然在使用 Outlook 2010，此程序基于的是旧式身份验证协议。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-264">For example, the users are still using Outlook 2010, which is based on legacy authentication protocols.</span></span> <span data-ttu-id="ff6b0-265">为这些合作伙伴代理启用 MFA 将中断旧式身份验证协议的使用。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-265">Enabling MFA for these partner agents will disrupt the use of legacy authentication protocols.</span></span>

<span data-ttu-id="ff6b0-266">**答案**：不能，这不是请求技术例外的有效理由。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-266">**Answer**: No, this isn't a valid reason for technical exception.</span></span> <span data-ttu-id="ff6b0-267">由于潜在的安全隐患问题，强烈建议合作伙伴避免使用旧式身份协议，因为不能通过 MFA 验证来保护这些协议并且这些协议更容易出现凭据泄露的问题。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-267">Partners are strongly encouraged to move away from the use of legacy authentication protocols because of potential security implications since these protocols cannot be protected with MFA verification and are much more susceptible to credential compromise.</span></span> <span data-ttu-id="ff6b0-268">如果无法避免使用旧式身份验证协议，合作伙伴应考虑注册支持使用应用程序密码的 Azure AD Premium。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-268">If moving away from the use of legacy authentication protocols is not an option, partners should consider signing up for Azure AD Premium, which supports the use of Application Passwords.</span></span> <span data-ttu-id="ff6b0-269">应用程序密码是系统生成的一次性密码，通常比人为生成的密码更强。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-269">Application Passwords are one-time system-generated passwords, and are usually stronger than human-generated passwords.</span></span> <span data-ttu-id="ff6b0-270">通过使用应用程序密码，合作伙伴可以为他们的用户实现 MFA，同时回退到仅适用于旧式身份验证协议的应用程序密码。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-270">By using Application Passwords, partners can implement MFA for their users, while falling back to Application Passwords for legacy authentication protocols only.</span></span>

<span data-ttu-id="ff6b0-271">阅读[基本身份验证和 Exchange Online](https://techcommunity.microsoft.com/t5/exchange-team-blog/basic-auth-and-exchange-online-february-2020-update/ba-p/1191282) 的相关文章以了解关于支持 Outlook 的旧式身份验证的最新计划，同时关注 [Exchange 团队博客](https://techcommunity.microsoft.com/t5/exchange-team-blog/bg-p/Exchange)以获取最新的资讯。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-271">Read the post about the [Basic Auth and Exchange Online](https://techcommunity.microsoft.com/t5/exchange-team-blog/basic-auth-and-exchange-online-february-2020-update/ba-p/1191282) to understand latest plan on supporting legacy authentication for Outlook, and follow the [Exchange team blog](https://techcommunity.microsoft.com/t5/exchange-team-blog/bg-p/Exchange) to get the upcoming news.</span></span> 

> [!NOTE]
> <span data-ttu-id="ff6b0-272">即使合作伙伴尚未为他们的合作伙伴代理实现 MFA，合作伙伴代理仍然可以使用合作伙伴委派的管理权限来访问 Microsoft Online Services 门户，只要在登录到客户租户期间出现提示时他们可以完成 MFA 注册和 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-272">Even though the partner hasn't implemented MFA for their partner agents, the partner agents can still access Microsoft Online Services Portals using Partner Delegated Administration Privileges provided they can complete MFA registration and MFA verification when prompted during sign-in to customer tenant.</span></span> <span data-ttu-id="ff6b0-273">完成 MFA 注册不会自动为用户启用 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-273">Completing MFA registration does not automatically enable the user for MFA.</span></span>

##### <a name="issue-6-partner-has-implemented-third-party-mfa-that-isnt-recognized-by-azure-ad"></a><span data-ttu-id="ff6b0-274">问题 6：合作伙伴实现了 Azure AD 无法识别的第三方 MFA</span><span class="sxs-lookup"><span data-stu-id="ff6b0-274">Issue 6: Partner has implemented third-party MFA that isn't recognized by Azure AD</span></span>
<span data-ttu-id="ff6b0-275">合作伙伴使用第三方 MFA 解决方案为他们的用户实现了 MFA。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-275">A partner has implemented MFA for their users using a third-party MFA solution.</span></span> <span data-ttu-id="ff6b0-276">但是，合作伙伴无法正确配置第三方 MFA 解决方案来中继至在用户身份验证期间已完成 MFA 验证的 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-276">However, the partner is unable to correctly configure the third-party MFA solution to relay to Azure AD that MFA verification has been completed during user authentication.</span></span> <span data-ttu-id="ff6b0-277">这能否成为请求技术例外的有效理由？</span><span class="sxs-lookup"><span data-stu-id="ff6b0-277">Is this a valid reason for technical exception?</span></span>

<span data-ttu-id="ff6b0-278">**答案**：能，此问题可能会被认为是请求技术例外的有效理由。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-278">**Answer**: Yes, this issue may be considered as a valid reason for technical exception.</span></span> <span data-ttu-id="ff6b0-279">提交请求技术例外时，请与第三方 MFA 解决方案提供商确认无法配置此 MFA 解决方案来将 authenticationmethodsreferences 声明（带有值 multipleauthn）传递给 Azure AD，以此来指示在用户身份验证期间已完成 MFA 验证 。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-279">Before submitting a request for technical exception, confirm with the third-party MFA solution provider that the MFA solution cannot be configured to flow the *authenticationmethodsreferences* claim (with value *multipleauthn*) to Azure AD to indicate that MFA verification has been completed during user authentication.</span></span> <span data-ttu-id="ff6b0-280">提交请求技术例外时，必须提供所用的第三方 MFA 解决方案的详细信息，指出集成方法（例如通过联合身份验证或使用 Azure AD 自定义控制），并在技术例外请求中提供以下信息作为支持文档：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-280">While submitting a request for technical exception, you must provide details of the third-party MFA solution used, and indicate method of integration (such as through identity federation or use of Azure AD Custom Control), and provide the following information in the technical exception request as the supporting documents:</span></span>

- <span data-ttu-id="ff6b0-281">第三方 MFA 配置。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-281">The third-party MFA configurations.</span></span>

- <span data-ttu-id="ff6b0-282">由启用了第三方 MFA 的帐户运行的[测试合作伙伴安全要求](/powershell/partnercenter/test-partner-security-requirements)的结果。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-282">The result of [Test the Partner Security Requirements](/powershell/partnercenter/test-partner-security-requirements) running by the third-party MFA enabled account.</span></span>

- <span data-ttu-id="ff6b0-283">你正在使用或计划使用的第三方 MFA 解决方案的采购订单。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-283">The purchase order of the third-party MFA solution you are using or you plan to use.</span></span>

## <a name="how-to-submit-a-request-for-technical-exception"></a><span data-ttu-id="ff6b0-284">如何提交请求技术例外</span><span class="sxs-lookup"><span data-stu-id="ff6b0-284">How to submit a request for technical exception</span></span>

<span data-ttu-id="ff6b0-285">如果合作伙伴遇到与 Microsoft Online Services 相关的技术问题并且没有可行的解决方案或暂时解决方法，他们可以申请技术例外以取消 MFA 验证。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-285">Partners can apply for technical exception to suppress MFA verification if they are encountering technical issues with Microsoft Online Services and there are no feasible solution or workaround.</span></span> <span data-ttu-id="ff6b0-286">在此之前，请查看上一节中的[常见问题列表](#list-of-common-issues)。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-286">Before doing so, review the [list of common issues](#list-of-common-issues) in the previous section.</span></span>

<span data-ttu-id="ff6b0-287">提交请求技术例外：</span><span class="sxs-lookup"><span data-stu-id="ff6b0-287">To submit a request for technical exception:</span></span>

1. <span data-ttu-id="ff6b0-288">以全局管理员或管理员代理的身份登录到合作伙伴中心。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-288">Sign in to Partner Center as Global Admin or Admin Agent.</span></span>

2. <span data-ttu-id="ff6b0-289">通过导航到“支持” > “合作伙伴支持请求”并选择“新建请求”来创建新的合作伙伴服务请求  。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-289">Create a new partner service request by navigating to **Support** > **Partner support requests** and selecting **New request**.</span></span>

3. <span data-ttu-id="ff6b0-290">在搜索框中搜索“MFA - 请求例外”；或从“类别”中选择“CSP”，然后从“主题”中选择“帐户、加入、访问”，接着从子主题中选择“MFA - 请求例外”，再选择“下一步”    。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-290">Search for **MFA - Request for exception** in the search box; or select **CSP** from Category, then select **Accounts, Onboarding, Access** from Topic, then select **MFA - Request for exception** from the subtopic, then select **next step**.</span></span>

4. <span data-ttu-id="ff6b0-291">提供提交技术例外服务请求所需的详细信息，然后选择“提交”。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-291">Provide details requested to submit a service request for technical exception and select **Submit**.</span></span>

<span data-ttu-id="ff6b0-292">Microsoft 可能在最长三个工作日的时间内响应技术例外请求。</span><span class="sxs-lookup"><span data-stu-id="ff6b0-292">Microsoft may take up to three working days to provide a response to a request for technical exception.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ff6b0-293">后续步骤</span><span class="sxs-lookup"><span data-stu-id="ff6b0-293">Next steps</span></span>

 - [<span data-ttu-id="ff6b0-294">合作伙伴安全要求状态</span><span class="sxs-lookup"><span data-stu-id="ff6b0-294">Partner security requirements status</span></span>](partner-security-compliance.md)